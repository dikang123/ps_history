/*
THIS FILE CONTAINS INDEXES FOR THE `ps_history` tables so that the 
sys_history views perform reasonably.  

These indexes are based on MySQL 8 (because it indexes performance_schema tables).  
There may be columns or tables referenced that are not valid in MySQL 5.7 or 
earlier.  Simply ignore any errors about missing tables or columns on earlier 
versions. 
*/
alter table ps_history.accounts ADD KEY(USER,HOST,`ts`);
alter table ps_history.cond_instances ADD KEY(NAME,`ts`);
alter table ps_history.cond_instances ADD KEY(OBJECT_INSTANCE_BEGIN,`ts`);
alter table ps_history.events_errors_summary_by_account_by_error ADD KEY(USER,HOST,ERROR_NUMBER,`ts`);
alter table ps_history.events_errors_summary_by_host_by_error ADD KEY(HOST,ERROR_NUMBER,`ts`);
alter table ps_history.events_errors_summary_by_thread_by_error ADD KEY(THREAD_ID,ERROR_NUMBER,`ts`);
alter table ps_history.events_errors_summary_by_user_by_error ADD KEY(USER,ERROR_NUMBER,`ts`);
alter table ps_history.events_errors_summary_global_by_error ADD KEY(ERROR_NUMBER,`ts`);
alter table ps_history.events_stages_current ADD KEY(THREAD_ID,EVENT_ID,`ts`);
alter table ps_history.events_stages_history ADD KEY(THREAD_ID,EVENT_ID,`ts`);
alter table ps_history.events_stages_summary_by_account_by_event_name ADD KEY(USER,HOST,EVENT_NAME,`ts`);
alter table ps_history.events_stages_summary_by_host_by_event_name ADD KEY(HOST,EVENT_NAME,`ts`);
alter table ps_history.events_stages_summary_by_thread_by_event_name ADD KEY(THREAD_ID,EVENT_NAME,`ts`);
alter table ps_history.events_stages_summary_by_user_by_event_name ADD KEY(USER,EVENT_NAME,`ts`);
alter table ps_history.events_stages_summary_global_by_event_name ADD KEY(EVENT_NAME,`ts`);
alter table ps_history.events_statements_current ADD KEY(THREAD_ID,EVENT_ID,`ts`);
alter table ps_history.events_statements_history ADD KEY(THREAD_ID,EVENT_ID,`ts`);
alter table ps_history.events_statements_summary_by_account_by_event_name ADD KEY(USER,HOST,EVENT_NAME,`ts`);
alter table ps_history.events_statements_summary_by_digest ADD KEY(SCHEMA_NAME,DIGEST,`ts`);
alter table ps_history.events_statements_summary_by_host_by_event_name ADD KEY(HOST,EVENT_NAME,`ts`);
alter table ps_history.events_statements_summary_by_program ADD KEY(OBJECT_TYPE,OBJECT_SCHEMA,OBJECT_NAME,`ts`);
alter table ps_history.events_statements_summary_by_thread_by_event_name ADD KEY(THREAD_ID,EVENT_NAME,`ts`);
alter table ps_history.events_statements_summary_by_user_by_event_name ADD KEY(USER,EVENT_NAME,`ts`);
alter table ps_history.events_statements_summary_global_by_event_name ADD KEY(EVENT_NAME,`ts`);
alter table ps_history.events_transactions_current ADD KEY(THREAD_ID,EVENT_ID,`ts`);
alter table ps_history.events_transactions_history ADD KEY(THREAD_ID,EVENT_ID,`ts`);
alter table ps_history.events_transactions_summary_by_account_by_event_name ADD KEY(USER,HOST,EVENT_NAME,`ts`);
alter table ps_history.events_transactions_summary_by_host_by_event_name ADD KEY(HOST,EVENT_NAME,`ts`);
alter table ps_history.events_transactions_summary_by_thread_by_event_name ADD KEY(THREAD_ID,EVENT_NAME,`ts`);
alter table ps_history.events_transactions_summary_by_user_by_event_name ADD KEY(USER,EVENT_NAME,`ts`);
alter table ps_history.events_transactions_summary_global_by_event_name ADD KEY(EVENT_NAME,`ts`);
alter table ps_history.events_waits_current ADD KEY(THREAD_ID,EVENT_ID,`ts`);
alter table ps_history.events_waits_history ADD KEY(THREAD_ID,EVENT_ID,`ts`);
alter table ps_history.events_waits_summary_by_account_by_event_name ADD KEY(USER,HOST,EVENT_NAME,`ts`);
alter table ps_history.events_waits_summary_by_host_by_event_name ADD KEY(HOST,EVENT_NAME,`ts`);
alter table ps_history.events_waits_summary_by_instance ADD KEY(EVENT_NAME,`ts`);
alter table ps_history.events_waits_summary_by_instance ADD KEY(OBJECT_INSTANCE_BEGIN,`ts`);
alter table ps_history.events_waits_summary_by_thread_by_event_name ADD KEY(THREAD_ID,EVENT_NAME,`ts`);
alter table ps_history.events_waits_summary_by_user_by_event_name ADD KEY(USER,EVENT_NAME,`ts`);
alter table ps_history.events_waits_summary_global_by_event_name ADD KEY(EVENT_NAME,`ts`);
alter table ps_history.file_instances ADD KEY(EVENT_NAME,`ts`);
alter table ps_history.file_instances ADD KEY(FILE_NAME,`ts`);
alter table ps_history.file_summary_by_event_name ADD KEY(EVENT_NAME,`ts`);
alter table ps_history.file_summary_by_instance ADD KEY(EVENT_NAME,`ts`);
alter table ps_history.file_summary_by_instance ADD KEY(FILE_NAME,`ts`);
alter table ps_history.file_summary_by_instance ADD KEY(OBJECT_INSTANCE_BEGIN,`ts`);
alter table ps_history.global_status ADD KEY(VARIABLE_NAME,`ts`);
alter table ps_history.global_variables ADD KEY(VARIABLE_NAME,`ts`);
alter table ps_history.host_cache ADD KEY(HOST,`ts`);
alter table ps_history.host_cache ADD KEY(IP,`ts`);
alter table ps_history.hosts ADD KEY(HOST,`ts`);
alter table ps_history.memory_summary_by_account_by_event_name ADD KEY(USER,HOST,EVENT_NAME,`ts`);
alter table ps_history.memory_summary_by_host_by_event_name ADD KEY(HOST,EVENT_NAME,`ts`);
alter table ps_history.memory_summary_by_thread_by_event_name ADD KEY(THREAD_ID,EVENT_NAME,`ts`);
alter table ps_history.memory_summary_by_user_by_event_name ADD KEY(USER,EVENT_NAME,`ts`);
alter table ps_history.memory_summary_global_by_event_name ADD KEY(EVENT_NAME,`ts`);
alter table ps_history.metadata_locks ADD KEY(OBJECT_TYPE,OBJECT_SCHEMA,OBJECT_NAME,`ts`);
alter table ps_history.metadata_locks ADD KEY(OWNER_THREAD_ID,OWNER_EVENT_ID,`ts`);
alter table ps_history.metadata_locks ADD KEY(OBJECT_INSTANCE_BEGIN,`ts`);
alter table ps_history.mutex_instances ADD KEY(LOCKED_BY_THREAD_ID,`ts`);
alter table ps_history.mutex_instances ADD KEY(NAME,`ts`);
alter table ps_history.mutex_instances ADD KEY(OBJECT_INSTANCE_BEGIN,`ts`);
alter table ps_history.objects_summary_global_by_type ADD KEY(OBJECT_TYPE,OBJECT_SCHEMA,OBJECT_NAME,`ts`);
alter table ps_history.prepared_statements_instances ADD KEY(OWNER_OBJECT_TYPE,OWNER_OBJECT_SCHEMA,OWNER_OBJECT_NAME,`ts`);
alter table ps_history.prepared_statements_instances ADD KEY(OWNER_THREAD_ID,OWNER_EVENT_ID,`ts`);
alter table ps_history.prepared_statements_instances ADD KEY(OBJECT_INSTANCE_BEGIN,`ts`);
alter table ps_history.prepared_statements_instances ADD KEY(STATEMENT_ID,`ts`);
alter table ps_history.prepared_statements_instances ADD KEY(STATEMENT_NAME,`ts`);
alter table ps_history.replication_applier_configuration ADD KEY(CHANNEL_NAME,`ts`);
alter table ps_history.replication_applier_status ADD KEY(CHANNEL_NAME,`ts`);
alter table ps_history.replication_applier_status_by_coordinator ADD KEY(CHANNEL_NAME,`ts`);
alter table ps_history.replication_applier_status_by_coordinator ADD KEY(THREAD_ID,`ts`);
alter table ps_history.replication_applier_status_by_worker ADD KEY(CHANNEL_NAME,WORKER_ID,`ts`);
alter table ps_history.replication_applier_status_by_worker ADD KEY(THREAD_ID,`ts`);
alter table ps_history.replication_connection_configuration ADD KEY(CHANNEL_NAME,`ts`);
alter table ps_history.replication_connection_status ADD KEY(CHANNEL_NAME,`ts`);
alter table ps_history.replication_connection_status ADD KEY(THREAD_ID,`ts`);
alter table ps_history.rwlock_instances ADD KEY(NAME,`ts`);
alter table ps_history.rwlock_instances ADD KEY(OBJECT_INSTANCE_BEGIN,`ts`);
alter table ps_history.rwlock_instances ADD KEY(WRITE_LOCKED_BY_THREAD_ID,`ts`);
alter table ps_history.session_account_connect_attrs ADD KEY(PROCESSLIST_ID,ATTR_NAME,`ts`);
alter table ps_history.session_connect_attrs ADD KEY(PROCESSLIST_ID,ATTR_NAME,`ts`);
alter table ps_history.session_status ADD KEY(VARIABLE_NAME,`ts`);
alter table ps_history.session_variables ADD KEY(VARIABLE_NAME,`ts`);
alter table ps_history.setup_actors ADD KEY(HOST,USER,`ROLE`,`ts`);
alter table ps_history.setup_consumers ADD KEY(NAME,`ts`);
alter table ps_history.setup_instruments ADD KEY(NAME,`ts`);
alter table ps_history.setup_objects ADD KEY(OBJECT_TYPE,OBJECT_SCHEMA,OBJECT_NAME,`ts`);
alter table ps_history.setup_timers ADD KEY(NAME,`ts`);
alter table ps_history.socket_instances ADD KEY(IP,PORT,`ts`);
alter table ps_history.socket_instances ADD KEY(OBJECT_INSTANCE_BEGIN,`ts`);
alter table ps_history.socket_instances ADD KEY(SOCKET_ID,`ts`);
alter table ps_history.socket_instances ADD KEY(THREAD_ID,`ts`);
alter table ps_history.socket_summary_by_event_name ADD KEY(EVENT_NAME,`ts`);
alter table ps_history.socket_summary_by_instance ADD KEY(EVENT_NAME,`ts`);
alter table ps_history.socket_summary_by_instance ADD KEY(OBJECT_INSTANCE_BEGIN,`ts`);
alter table ps_history.status_by_account ADD KEY(USER,HOST,VARIABLE_NAME,`ts`);
alter table ps_history.status_by_host ADD KEY(HOST,VARIABLE_NAME,`ts`);
alter table ps_history.status_by_thread ADD KEY(THREAD_ID,VARIABLE_NAME,`ts`);
alter table ps_history.status_by_user ADD KEY(USER,VARIABLE_NAME,`ts`);
alter table ps_history.table_handles ADD KEY(OBJECT_TYPE,OBJECT_SCHEMA,OBJECT_NAME,`ts`);
alter table ps_history.table_handles ADD KEY(OWNER_THREAD_ID,OWNER_EVENT_ID,`ts`);
alter table ps_history.table_handles ADD KEY(OBJECT_INSTANCE_BEGIN,`ts`);
alter table ps_history.table_io_waits_summary_by_index_usage ADD KEY(OBJECT_TYPE,OBJECT_SCHEMA,OBJECT_NAME,INDEX_NAME,`ts`);
alter table ps_history.table_io_waits_summary_by_table ADD KEY(OBJECT_TYPE,OBJECT_SCHEMA,OBJECT_NAME,`ts`);
alter table ps_history.table_lock_waits_summary_by_table ADD KEY(OBJECT_TYPE,OBJECT_SCHEMA,OBJECT_NAME,`ts`);
alter table ps_history.threads ADD KEY(NAME,`ts`);
alter table ps_history.threads ADD KEY(THREAD_ID,`ts`);
alter table ps_history.threads ADD KEY(PROCESSLIST_USER,PROCESSLIST_HOST,`ts`);
alter table ps_history.threads ADD KEY(PROCESSLIST_HOST,`ts`);
alter table ps_history.threads ADD KEY(PROCESSLIST_ID,`ts`);
alter table ps_history.threads ADD KEY(THREAD_OS_ID,`ts`);
alter table ps_history.user_variables_by_thread ADD KEY(THREAD_ID,VARIABLE_NAME,`ts`);
alter table ps_history.users ADD KEY(USER,`ts`);
alter table ps_history.variables_by_thread ADD KEY(THREAD_ID,VARIABLE_NAME,`ts`);
